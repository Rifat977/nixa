{% extends 'root/partial/base.html' %}

{% block title %}Application || Nixaglobal{% endblock %}

{% load static %}

{% block content %}
<!-- breadcrumb start -->
<section class="breadcrumb pos-rel bg_img" data-background="{% static '/root/assets/img/bg/breadcrumb_bg.jpg' %}">
    <div class="container">
        <div class="breadcrumb__content">
            <h2 class="breadcrumb__title">Application</h2>
            <ul class="breadcrumb__list clearfix">
                <li class="breadcrumb-item"><a href="{% url 'core:index' %}">Home</a></li>
                <li class="breadcrumb-item">Application</li>
            </ul>
        </div>
    </div>
    <div class="breadcrumb__circle">
        <span class="big" data-parallax='{"y" : 100, "scale" : 0.1}'></span>
        <span class="small" data-parallax='{"y" : 100, "scale" : 0.1}'></span>
    </div>
    <div class="breadcrumb__shape">
        <div class="shape shape--1">
            <div class="shape-inner" data-parallax='{"x":-50,"y":80}'>
                <img src="{% static '/root/assets/img/shape/br_shape1.png' %}" alt="">
            </div>
        </div>
        <div class="shape shape--2">
            <div class="shape-inner" data-parallax='{"x":50,"y":-90}'>
                <img src="{% static '/root/assets/img/shape/br_shape2.png' %}" alt="">
            </div>
        </div>
    </div>
</section>
<!-- breadcrumb end -->

<section class="contact pt-120 pb-120">
    <div class="container">
        <div class="row justify-content-md-center mt-none-30">
            <div class="col-md-12">
                <h2 class="text-center mb-4">Application Form</h2>
                <form class="xb-item--form contact-from" method="post" action="{% url 'core:application' %}" enctype="multipart/form-data">
                    {% csrf_token %}
                    <!-- Row 1: Name and Reference Code -->
                    <div class="row">
                        <div class="col-md-6">
                            <label for="name" class="mb-2">Full Name</label>
                            <div class="xb-item--field">
                                <input type="text" name="name" class="form-control" id="name" placeholder="Enter your name" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="reference_code" class="mb-2">Reference Code (optional)</label>
                            <div class="xb-item--field">
                                <input type="text" name="reference_code" class="form-control" id="reference_code" placeholder="Enter your reference code">
                            </div>
                        </div>
                    </div>

                    <!-- Row 2: Phone and Email -->
                    <div class="row">
                        <div class="col-md-6">
                            <label for="phone" class="mb-2">Phone</label>
                            <div class="xb-item--field">
                                <input type="tel" name="phone" class="form-control" id="phone" placeholder="Enter your phone number" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="email" class="mb-2">Email</label>
                            <div class="xb-item--field">
                                <input type="email" name="email" class="form-control" id="email" placeholder="Enter your email" required>
                            </div>
                        </div>
                    </div>

                    <!-- Row 3: Gender and Passport Number -->
                    <div class="row">
                        <div class="col-md-6">
                            <label for="passport_number" class="mb-2">Passport Number</label>
                            <div class="xb-item--field">
                                <input type="text" name="passport_number" class="form-control" id="passport_number" placeholder="Enter your passport number" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="gender" class="mb-2">Gender</label>
                            <div class="xb-item--field">
                                <select class="form-control" name="gender" id="gender" required>
                                    <option value="" disabled selected>Gender</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Row 4: Date of Birth and SSC Year -->
                    <div class="row">
                        <div class="col-md-6">
                            <label for="date_of_birth" class="mb-2">Date of Birth</label>
                            <div class="xb-item--field">
                                <input type="date" name="date_of_birth" class="form-control" id="date_of_birth" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="ssc_year" class="mb-2">Highest Qualification</label>
                            <div class="xb-item--field">
                                <input type="text" name="highest_qualification" class="form-control" id="highest_qualification" placeholder="Highest Qualification" required>
                            </div>
                        </div>
                    </div>

                    <!-- Row 5: SSC Result and HSC Year -->
                    <div class="row">
                        <div class="col-md-6">
                            <label for="ssc_result" class="mb-2">Year Of Passing</label>
                            <div class="xb-item--field">
                                <input type="text" name="year_of_passing" class="form-control" id="ssc_result" placeholder="Year of Passing" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="bachelor_result" class="mb-2">Do you have any English Proficiency examination certificate?</label>
                            <div class="xb-item--field">
                                <select class="form-control" name="english_language_certificate" id="english_language_certificate" required>
                                    <option value="" disabled selected>Choose option</option>
                                    <option value="True">Yes</option>
                                    <option value="False">No</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Row: Select Program and University -->
                    <div class="row">
                        <div class="col-md-6">
                            <label for="program" class="mb-2">Select Program</label>
                            <div class="xb-item--field">
                                <select class="form-control" name="program" id="program" required>
                                    <option value="" disabled selected>Select Program</option>
                                    {% for program in programs %}
                                    <option value="{{ program.id }}">{{ program.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <label for="university" class="mb-2">Interested University</label>
                            <div class="xb-item--field">
                                <select class="form-control" name="university" id="university" required>
                                    <option value="" disabled selected>Select University</option>
                                    {% for university in universities %}
                                    <option value="{{ university.id }}">{{ university.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Subject Select Dropdown -->
                    <div class="col-md-6">
                        <label for="subjects-dropdown" class="mb-2">Select Subject</label>
                        <div class="xb-item--field">
                            <select class="form-control" name="subject" id="subjects-dropdown" required>
                                <option value="" disabled selected>Select Subject</option>
                            </select>
                        </div>
                    </div>



                    <!-- Row 10: Certificate Upload and Passport Information Page -->
                    <div class="row">
                        <div class="col-md-6">
                            <label for="certificate_upload" class="mb-2">Upload Certificate</label>
                            <div class="xb-item--field">
                                <input type="file" class="form-control" name="certificate_upload" id="certificate_upload" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="passport_information_page" class="mb-2">Passport Information Page</label>
                            <div class="xb-item--field">
                                <input type="file" class="form-control" name="passport_information_page" id="passport_information_page" required>
                            </div>
                        </div>
                    </div>

                    <div class="text-center mt-4">
                        <button type="submit" class="btn btn-lg text-light" style="background-color: #fe8103;">Submit Application</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const programDropdown = document.getElementById('program');
    const universityDropdown = document.getElementById('university');
    const subjectsDropdown = document.getElementById('subjects-dropdown');

    function loadSubjects() {
        const programId = programDropdown.value;
        const universityId = universityDropdown.value;

        if (programId && universityId) {
            fetch(`/get-subjects/${programId}/${universityId}`)
                .then(response => response.json())
                .then(data => {
                    subjectsDropdown.innerHTML = '<option value="" disabled selected>Select Subject</option>';

                    data.subjects.forEach(subject => {
                        subjectsDropdown.innerHTML += `
                            <option value="${subject.id}">${subject.name} - Fee: ${subject.fee}</option>`;
                    });
                })
                .catch(error => console.error('Error fetching subjects:', error));
        }
    }

    programDropdown.addEventListener('change', loadSubjects);
    universityDropdown.addEventListener('change', loadSubjects);
});

</script>


{% endblock %}
